---
author: å¾¡é¦™çƒ¤ç¿…
aliases: []
tags: maven
---
# ç¬¬ä¸€èŠ‚ æ­å»º Maven ç§æœï¼šNexus
## 1ã€Nexus å®‰è£…
### â‘ ä¸‹è½½åœ°å€ï¼ˆæœ€å¥½ä½¿ç”¨è¿…é›·ä¸‹è½½ï¼‰
> https://download.sonatype.com/nexus/3/latest-unix.tar.gz

> æ³¨æ„å®‰è£… nexus å¿…é¡»è¦jdkæ˜¯ 8 ï¼Œä¸ç„¶ä¼šæŠ¥é”™
> å¦‚è‹¥å½“å‰çš„java -version ä¸æ˜¯ jdk1.8 åˆ™éœ€è¦ ï¼Œé¦–å…ˆ å®‰è£… jdk1.8,å¯ä»¥ä¸é…ç½®åˆ°ç¯å¢ƒå˜é‡
> 1. å®‰è£…jdk `yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel`
> 2. ä¸éœ€è¦é…ç½® ç¯å¢ƒå˜é‡
> 3. åœ¨ è€Œæ˜¯åœ¨nexux/bin/nexusæ–‡ä»¶é…ç½®äº†INSTALL4J_JAVA_HOME_OVERRIDEï¼Œå¦‚ä¸‹
> 4. >`INSTALL4J_JAVA_HOME_OVERRIDE=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.352.b08-2.el7_9.x86_64`
> 5. å¦‚å›¾ï¼š![](images/Pasted%20image%2020221128153159.png)
> 6. ç„¶åå†æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤è¿›è¡Œï¼Œå®‰è£…


### â‘¡ä¸Šä¼ ã€è§£å‹
ä¸Šä¼ åˆ° Linux ç³»ç»Ÿï¼Œè§£å‹åå³å¯ä½¿ç”¨ï¼Œä¸éœ€è¦å®‰è£…ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ï¼šå¿…é¡»æå‰å®‰è£… JDKã€‚
```sh
[root@localhost nexus-3.43.0-01]# pwd
/test-nexus/nexus-3.43.0-01
[root@localhost nexus-3.43.0-01]# ll
æ€»ç”¨é‡ 76
drwxr-xr-x  3 root root    73 10æœˆ 13 20:11 bin
drwxr-xr-x  2 root root    26 10æœˆ 13 20:11 deploy
drwxr-xr-x  7 root root   104 10æœˆ 13 20:11 etc
drwxr-xr-x  5 root root   239 10æœˆ 13 20:11 lib
-rw-r--r--  1 root root   651 11æœˆ  7 2022 NOTICE.txt
-rw-r--r--  1 root root 17321 11æœˆ  7 2022 OSS-LICENSE.txt
-rw-r--r--  1 root root 41954 11æœˆ  7 2022 PRO-LICENSE.txt
drwxr-xr-x  2 root root  4096 10æœˆ 13 20:11 public
drwxr-xr-x  3 root root    59 10æœˆ 13 20:11 replicator
drwxr-xr-x 23 root root  4096 10æœˆ 13 20:11 system
[root@localhost nexus-3.43.0-01]#
```
### â‘¢å¯åŠ¨ Nexus 
```sh
[root@localhost bin]# ./nexus start
WARNING: ************************************************************
WARNING: Detected execution as "root" user.  This is NOT recommended!
WARNING: ************************************************************
Starting nexus
[root@localhost bin]# ./nexus status
WARNING: ************************************************************
WARNING: Detected execution as "root" user.  This is NOT recommended!
WARNING: ************************************************************
nexus is running.
[root@localhost bin]#
```

### â‘£æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µ
`netstat -anp | grep java`
```sh
[root@localhost bin]#  netstat -anp | grep java
tcp        0      0 0.0.0.0:8081            0.0.0.0:*               LISTEN      2671/java
tcp        0      0 127.0.0.1:43496         0.0.0.0:*               LISTEN      2671/java
unix  3      [ ]         STREAM     CONNECTED     25839    2671/java
unix  3      [ ]         STREAM     CONNECTED     25840    2671/java
unix  3      [ ]         STREAM     CONNECTED     25838    2671/java
unix  3      [ ]         STREAM     CONNECTED     25837    2671/java
unix  2      [ ]         STREAM     CONNECTED     25832    2671/java
unix  2      [ ]         STREAM     CONNECTED     25828    2671/java
```

ä¸Šé¢ 43496 è¿™ä¸ªæ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œä¸ç”¨ç®¡å®ƒã€‚æˆ‘ä»¬è¦è®¿é—®çš„æ˜¯ 8081 è¿™ä¸ªç«¯å£ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ï¼š8081 ç«¯å£çš„è¿™ä¸ªè¿›ç¨‹è¦åœ¨å¯åŠ¨ /opt/nexus-3.37.0-01/bin/nexus è¿™ä¸ªä¸»ä½“ç¨‹åºä¸€ã€ä¸¤åˆ†é’Ÿåæ‰ä¼šå¯åŠ¨ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚

### â‘¤è®¿é—® Nexus é¦–é¡µ
é¦–é¡µåœ°å€ï¼šhttp://[Linux æœåŠ¡å™¨åœ°å€]:8081/
åˆå§‹åŒ–ç•Œé¢è¿˜æ˜¯å¾ˆé…·çš„ï¼š
![](images/Pasted%20image%2020221128153508.png)

## 2ã€åˆå§‹è®¾ç½®
![](images/Pasted%20image%2020221128153647.png)
![](images/Pasted%20image%2020221128153752.png)
è¿™é‡Œå‚è€ƒæç¤ºï¼š
-   ç”¨æˆ·åï¼šadmin
-   å¯†ç ï¼šæŸ¥çœ‹ /test-nexus/sonatype-work/nexus3/admin.password æ–‡ä»¶
`cat /test-nexus/sonatype-work/nexus3/admin.password`
```
[root@localhost sonatype-work]# cat /test-nexus/sonatype-work/nexus3/admin.password
dc6bdfd5-370a-4121-9dd2-4168c49ecf7f[root@localhost sonatype-work]#
```
æ‰€ä»¥ç™»å½•ä¿¡æ¯è¾“å…¥å¦‚ä¸‹ï¼š
![](images/Pasted%20image%2020221128154039.png)
ç»§ç»­æ‰§è¡Œåˆå§‹åŒ–
![](images/Pasted%20image%2020221128154055.png)
ç»™ admin ç”¨æˆ·æŒ‡å®šæ–°å¯†ç ï¼ˆè¿™é‡ŒæŒ‡å®šçš„ä¸º 123456ï¼‰ï¼š 
![](images/Pasted%20image%2020221128154108.png)
åŒ¿åç™»å½•ï¼Œå¯ç”¨è¿˜æ˜¯ç¦ç”¨ï¼Ÿç”±äºå¯ç”¨åŒ¿åç™»å½•åï¼Œåç»­æ“ä½œæ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºç¦ç”¨åŒ¿åç™»å½•çš„æ“ä½œæ–¹å¼ï¼š
![](images/Pasted%20image%2020221128154203.png)
å®Œæˆï¼š
![](images/Pasted%20image%2020221128154223.png)

## 3ã€å¯¹æ¥ Nexus
### â‘ é€šè¿‡ Nexus ä¸‹è½½ jar åŒ…

#### [1]äº†è§£ Nexus ä¸Šçš„å„ç§ä»“åº“
![](images/Pasted%20image%2020221128154341.png)
|ä»“åº“ç±»å‹|è¯´æ˜|
|:-----|:-----|
|proxy|æŸä¸ªè¿œç¨‹ä»“åº“çš„ä»£ç†|
|group|å­˜æ”¾ï¼šé€šè¿‡ Nexus è·å–çš„ç¬¬ä¸‰æ–¹ jar åŒ…|
|hosted|å­˜æ”¾ï¼šæœ¬å›¢é˜Ÿå…¶ä»–å¼€å‘äººå‘˜éƒ¨ç½²åˆ° Nexus çš„ jar åŒ…|

|ä»“åº“åç§°|è¯´æ˜|
|:-----|:-----|
|maven-public|Nexus é»˜è®¤åˆ›å»ºï¼Œä¾›å¼€å‘äººå‘˜ä¸‹è½½ä½¿ç”¨çš„ç»„ä»“åº“|
|maven-releasse|Nexus é»˜è®¤åˆ›å»ºï¼Œä¾›å¼€å‘äººå‘˜éƒ¨ç½²è‡ªå·± jar åŒ…çš„å®¿ä¸»ä»“åº“è¦æ±‚ releasse ç‰ˆæœ¬|
|maven-snapshots|Nexus é»˜è®¤åˆ›å»ºï¼Œä¾›å¼€å‘äººå‘˜éƒ¨ç½²è‡ªå·± jar åŒ…çš„å®¿ä¸»ä»“åº“è¦æ±‚ snapshots ç‰ˆæœ¬|

åˆå§‹çŠ¶æ€ä¸‹ï¼Œè¿™å‡ ä¸ªä»“åº“éƒ½æ²¡æœ‰å†…å®¹ï¼š
![](images/Pasted%20image%2020221128154648.png)

### ğŸ’ªä¿®æ”¹ä»“åº“çš„é…ç½®
ä¸¾ä¾‹ï¼šä¿®æ”¹ maven-central ä»“åº“ä»£ç†çš„è¿œç¨‹åº“åœ°å€
![](images/Pasted%20image%2020221128154909.png)

![](images/Pasted%20image%2020221128154916.png)
![](images/Pasted%20image%2020221128154929.png)

#### [2]ä½¿ç”¨ç©ºçš„æœ¬åœ°ä»“åº“
![](images/Pasted%20image%2020221128155202.png)
```xml
  <!-- é…ç½®ä¸€ä¸ªæ–°çš„ Maven æœ¬åœ°ä»“åº“ -->
<localRepository>D:\javaSoft\mavenRepository-new</localRepository>
```

#### [3]æŒ‡å®š Nexus æœåŠ¡å™¨åœ°å€
æŠŠæˆ‘ä»¬åŸæ¥é…ç½®é˜¿é‡Œäº‘ä»“åº“åœ°å€çš„ mirror æ ‡ç­¾æ”¹æˆä¸‹é¢è¿™æ ·ï¼š
```xml
	<mirror>
		<id>nexus-mine</id>
		<mirrorOf>central</mirrorOf>
		<name>Nexus mine</name>
		<url>http://10.9.10.119:8081/repository/maven-public/</url>
	</mirror>
```
è¿™é‡Œçš„ url æ ‡ç­¾æ˜¯è¿™ä¹ˆæ¥çš„ï¼š
![](images/Pasted%20image%2020221128155257.png)
![](images/Pasted%20image%2020221128155425.png)
æŠŠä¸Šå›¾ä¸­çœ‹åˆ°çš„åœ°å€å¤åˆ¶å‡ºæ¥å³å¯ã€‚å¦‚æœæˆ‘ä»¬åœ¨å‰é¢å…è®¸äº†åŒ¿åè®¿é—®ï¼Œåˆ°è¿™é‡Œå°±å¤Ÿäº†ã€‚ä½†å¦‚æœæˆ‘ä»¬ç¦ç”¨äº†åŒ¿åè®¿é—®ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è¿˜è¦ç»§ç»­é…ç½® settings.xmlï¼š
```xml
<server>
  <id>nexus-mine</id>
  <username>admin</username>
  <password>123456</password>
</server>
```
**è¿™é‡Œéœ€è¦æ ¼å¤–æ³¨æ„ï¼šserverÂ æ ‡ç­¾å†…çš„ id æ ‡ç­¾å€¼å¿…é¡»å’Œ mirror æ ‡ç­¾ä¸­çš„ id å€¼ä¸€æ ·ã€‚**

#### [4]æ•ˆæœ
æ‰¾ä¸€ä¸ªç”¨åˆ°æ¡†æ¶çš„ Maven å·¥ç¨‹ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š
```sh
mvn clean compile
```

æ—¥å¿—æ˜¾ç¤ºæˆªå›¾ï¼š
![](images/Pasted%20image%2020221128160043.png)

ä¸‹è½½åï¼ŒNexus æœåŠ¡å™¨ä¸Šå°±æœ‰äº† jar åŒ…ï¼š
![](images/Pasted%20image%2020221128160213.png)

### â‘¡å°† jar åŒ…éƒ¨ç½²åˆ° Nexus
#### [1]é…ç½® Maven å·¥ç¨‹
æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯ 
![](images/Pasted%20image%2020221128160846.png)
```xml
<distributionManagement>
    <snapshotRepository>
        <id>nexus-mine</id>
        <name>Nexus Snapshot</name>
        <url>http://10.9.10.119:8081/repository/maven-snapshots/</url>
    </snapshotRepository>
</distributionManagement>
```
**è¿™é‡Œ snapshotRepository çš„ id æ ‡ç­¾ä¹Ÿå¿…é¡»å’Œ settings.xml ä¸­æŒ‡å®šçš„ mirror æ ‡ç­¾çš„ id å±æ€§ä¸€è‡´ã€‚**

#### [2]æ‰§è¡Œéƒ¨ç½²å‘½ä»¤
![](images/Pasted%20image%2020221128161018.png)
nexus mavenä»“åº“
![](images/Pasted%20image%2020221128161141.png)

### â‘¢å¼•ç”¨åˆ«äººéƒ¨ç½²çš„ jar åŒ…
#### [1]æå‡ºé—®é¢˜
-   é»˜è®¤è®¿é—®çš„ Nexus ä»“åº“ï¼šmaven-public
-  å­˜æ”¾åˆ«äººéƒ¨ç½² jar åŒ…çš„ä»“åº“ï¼šmaven-snapshots

#### [2]é…ç½® Maven å·¥ç¨‹
```xml
<repositories>
    <repository>
        <id>nexus-mine</id>
        <name>nexus-mine</name>
        <url>http://10.9.10.119:8081/repository/maven-snapshots/</url>
        <snapshots>
            <enabled>true</enabled>
        </snapshots>
        <releases>
            <enabled>true</enabled>
        </releases>
    </repository>
</repositories>
```

## 4. ğŸ¥•å®è·µçš„ç»“æœï¼ˆæ—¢æœ‰ å¿«ç…§ç‰ˆæœ¬ï¼ˆsnapshotsï¼‰åˆæœ‰æ­£å¼ç‰ˆæœ¬ï¼ˆreleasesï¼‰ï¼‰
![](images/Pasted%20image%2020221207095104.png)

åœ¨setting.xmlä¸­çš„é…ç½® 

é¦–å…ˆmirrorsä¸­é…ç½®ä¸¤ä¸ª
```xml
  <mirrors>
	<mirror>
		<id>nexus-public</id>
		<mirrorOf>central</mirrorOf>
		<name>Nexus mine</name>
		<url>http://10.9.10.119:8081/repository/maven-public/</url>
	</mirror>
	
	<mirror>
		<id>nexus-snapshots</id>
		<mirrorOf>central</mirrorOf>
		<name>nexus-snapshots</name>
		<url>http://10.9.10.119:8081/repository/maven-snapshots/</url>
	</mirror>

  </mirrors>
```

serverä¸­é…ç½®ä¸¤ä¸ª
```xml
  <servers>
	<server>
	  <id>nexus-public</id>
	  <username>admin</username>
	  <password>123456</password>
  </server>
  	<server>
	  <id>nexus-snapshots</id>
	  <username>admin</username>
	  <password>123456</password>
  </server>
    </servers>
```

åœ¨é¡¹ç›®çš„pomä¸­é…ç½®çš„æ—¶å€™ï¼Œ**åªéœ€è¦é…ç½® å¿«ç…§çš„ repositoryè¿™ä¸€ä¸ªå°±å¯ä»¥äº†**ï¼Œè¿™æ ·å°±èƒ½æ‹‰å–åˆ°å¿«ç…§ä¸­çš„ç‰ˆæœ¬ï¼Œè‡ªå·±å‘å¸ƒçš„ releases ç‰ˆæœ¬è¿˜æœ‰ï¼Œå¤–ç½‘çš„ï¼ˆé˜¿é‡Œäº‘ä»“åº“ï¼‰éƒ½èƒ½æ‹‰å–ã€‚

pomä¸­é…ç½®ï¼š
```xml
<repositories>  
    <repository>  
        <id>nexus-snapshots</id>  
        <name>nexus-snapshots</name>  
        <url>http://10.9.10.119:8081/repository/maven-snapshots/</url>  
        <snapshots>  
            <enabled>true</enabled>  
        </snapshots>  
        <releases>  
            <enabled>true</enabled>  
        </releases>  
    </repository>  
</repositories>
```

## ğŸ¥•ç¼–è¯‘æŒ‡å®šæ¨¡å—çš„ä»£ç 
```sh
mvn clean install -pl wangxiao-resources  -am -Dmaven.test.skip=true
```

## ğŸ¥•æ‰“åŒ…åˆ°nexusä»“åº“ï¼Œè·³è¿‡testæ¨¡å—æµ‹è¯•çš„å‘½ä»¤
```sh
mvn clean deploy -Dmaven.test.skip=true
```
## ğŸ¥•æŸ¥çœ‹è¯¥pomå¯¹åº”çš„é¡¹ç›®å—å½±å“çš„setting.xmlé…ç½®
```sh
mvn help:effective-settings
```

## ğŸ¥•æŸ¥çœ‹è¯¥pomå¯¹åº”çš„é¡¹ç›®å—å½±å“çš„pomé…ç½®
```sh
mvn help:effective-pom -Dverbose
```
# ç¬¬äºŒèŠ‚ jaråŒ…å†²çªé—®é¢˜
## 1ã€è°éœ€è¦é¢å¯¹ jar åŒ…å†²çªï¼Ÿ
å…ˆç»™ç»“è®ºï¼šç¼–è®¢ä¾èµ–åˆ—è¡¨çš„ç¨‹åºå‘˜ã€‚åˆæ¬¡è®¾å®šä¸€ç»„ä¾èµ–ï¼Œå› ä¸ºå°šæœªç»è¿‡éªŒè¯ï¼Œæ‰€ä»¥ç¡®å®æœ‰å¯èƒ½å­˜åœ¨å„ç§é—®é¢˜ï¼Œéœ€è¦åšæœ‰é’ˆå¯¹æ€§çš„è°ƒæ•´ã€‚é‚£ä¹ˆè°æ¥åšè¿™ä»¶äº‹å‘¢ï¼Ÿæˆ‘ä»¬æœ€ä¸å¸Œæœ›çœ‹åˆ°çš„å°±æ˜¯ï¼šå›¢é˜Ÿä¸­æ¯ä¸ªç¨‹åºå‘˜éƒ½éœ€è¦è‡ªå·±å»æ‰¾ä¾èµ–ï¼Œå³ä½¿æ˜¯åšåŒä¸€ä¸ªé¡¹ç›®ï¼Œæ¯ä¸ªæ¨¡å—ä¹Ÿå„åŠ å„çš„ä¾èµ–ï¼Œæ²¡æœ‰ç»Ÿä¸€ç®¡ç†ã€‚é‚£å‰äººè¸©è¿‡çš„å‘ï¼Œåäººè¿˜è¦å†è¸©ä¸€éã€‚è€Œä¸”å¤§å®¶ç”¨çš„ä¾èµ–æœ‰å¾ˆå¤šç»†èŠ‚éƒ½ä¸ä¸€æ ·ï¼Œç‰ˆæœ¬æ›´æ˜¯äº”èŠ±å…«é—¨ï¼Œè¿™å°±è®©äº‹æƒ…å˜å¾—æ›´åŠ å¤æ‚ã€‚

æ‰€ä»¥è™½ç„¶åˆæœŸéœ€è¦æ ¹æ®é¡¹ç›®å¼€å‘å’Œå®é™…è¿è¡Œæƒ…å†µå¯¹ä¾èµ–é…ç½®ä¸æ–­è°ƒæ•´ï¼Œæœ€ç»ˆç¡®å®šä¸€ä¸ªå„æ–¹é¢éƒ½ OK çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ä¸€æ—¦ç¡®å®šä¸‹æ¥ï¼Œæ”¾åœ¨çˆ¶å·¥ç¨‹ä¸­åšä¾èµ–ç®¡ç†ï¼Œå„ä¸ªå­æ¨¡å—å„å–æ‰€éœ€ï¼Œè¿™æ ·åŸºæœ¬ä¸Šå°±èƒ½å¾ˆå¥½çš„é¿å…é—®é¢˜çš„æ‰©æ•£ã€‚

å³ä½¿å¼€å‘ä¸­é‡åˆ°äº†æ–°é—®é¢˜ï¼Œä¹Ÿå¯ä»¥å›åˆ°æºå¤´æ£€æŸ¥ã€è°ƒæ•´ dependencyManagement é…ç½®çš„åˆ—è¡¨â€”â€”è€Œä¸æ˜¯æ¯ä¸ªæ¨¡å—éƒ½è¦æ”¹ã€‚æ‰€ä»¥å­¦å®Œè¿™ä¸€èŠ‚ä½ åº”è¯¥å°±ä¼šå¯¹å‰é¢è®²è¿‡çš„ã€ç»§æ‰¿ã€æœ‰äº†æ›´æ·±çš„ç†è§£ã€‚

## 2ã€è¡¨ç°å½¢å¼
ç”±äºå®é™…å¼€å‘æ—¶æˆ‘ä»¬å¾€å¾€éƒ½ä¼šæ•´åˆä½¿ç”¨å¾ˆå¤šå¤§å‹æ¡†æ¶ï¼Œæ‰€ä»¥ä¸€ä¸ªé¡¹ç›®ä¸­å“ªæ€•åªæ˜¯ä¸€ä¸ªæ¨¡å—ä¹Ÿä¼šæ¶‰åŠåˆ°å¤§é‡ jar åŒ…ã€‚æ•°ä»¥ç™¾è®¡çš„ jar åŒ…è¦å½¼æ­¤åè°ƒã€ç²¾å¯†é…åˆæ‰èƒ½ä¿è¯ç¨‹åºæ­£å¸¸è¿è¡Œã€‚è€Œè§„æ¨¡å¦‚æ­¤åºå¤§çš„ jar åŒ…ç»„åˆåœ¨ä¸€èµ·éš¾å…ä¼šæœ‰ç£•ç£•ç¢°ç¢°ã€‚æœ€å…³é”®çš„æ˜¯ç”±äº jar åŒ…å†²çªæ‰€å¯¼è‡´çš„é—®é¢˜éå¸¸è¯¡å¼‚ï¼Œè¿™é‡Œæˆ‘ä»¬åªèƒ½ç½—åˆ—è¾ƒä¸ºå…¸å‹çš„é—®é¢˜ï¼Œè€Œæ²¡æ³•ä¿è¯ç©·ä¸¾ã€‚

ä½†æ˜¯æˆ‘ä»¬ä»ç„¶èƒ½å¤ŸæŒ‡å‡ºä¸€ç‚¹ï¼šä¸€èˆ¬æ¥è¯´ï¼Œç”±äºæˆ‘ä»¬è‡ªå·±ç¼–å†™ä»£ç ã€é…ç½®æ–‡ä»¶å†™é”™æ‰€å¯¼è‡´çš„é—®é¢˜é€šå¸¸èƒ½å¤Ÿåœ¨å¼‚å¸¸ä¿¡æ¯ä¸­çœ‹åˆ°æˆ‘ä»¬è‡ªå·±ç±»çš„å…¨ç±»åæˆ–é…ç½®æ–‡ä»¶çš„æ‰€åœ¨è·¯å¾„ã€‚å¦‚æœæ•´ä¸ªé”™è¯¯ä¿¡æ¯ä¸­å®Œå…¨æ²¡æœ‰æˆ‘ä»¬è´Ÿè´£çš„éƒ¨åˆ†ï¼Œå…¨éƒ¨æ˜¯æ¡†æ¶ã€ç¬¬ä¸‰æ–¹å·¥å…·åŒ…é‡Œé¢çš„ç±»æŠ¥é”™ï¼Œè¿™å¾€å¾€å°±æ˜¯ jar åŒ…çš„é—®é¢˜æ‰€å¼•èµ·çš„ã€‚

è€Œå…·ä½“çš„è¡¨ç°å½¢å¼ä¸­ï¼Œä¸»è¦ä½“ç°ä¸ºæ‰¾ä¸åˆ°ç±»æˆ–æ‰¾ä¸åˆ°æ–¹æ³•ã€‚.

### â‘ æŠ›å¼‚å¸¸ï¼šæ‰¾ä¸åˆ°ç±»
æ­¤æ—¶æŠ›å‡ºçš„å¸¸è§çš„å¼‚å¸¸ç±»å‹ï¼š

-   java.lang.ClassNotFoundExceptionï¼šç¼–è¯‘è¿‡ç¨‹ä¸­æ‰¾ä¸åˆ°ç±»
-   java.lang.NoClassDefFoundErrorï¼šè¿è¡Œè¿‡ç¨‹ä¸­æ‰¾ä¸åˆ°ç±»
-   java.lang.LinkageErrorï¼šä¸åŒç±»åŠ è½½å™¨åˆ†åˆ«åŠ è½½çš„å¤šä¸ªç±»æœ‰ç›¸åŒçš„å…¨é™å®šå

æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ï¼š
```xml
<dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.x.x</version>
</dependency>
```

httpclient è¿™ä¸ª jar åŒ…ä¸­æœ‰ä¸€ä¸ªç±»ï¼šorg.apache.http.conn.ssl.NoopHostnameVerifierã€‚è¿™ä¸ªç±»åœ¨è¾ƒä½ç‰ˆæœ¬ä¸­æ²¡æœ‰ï¼Œä½†åœ¨è¾ƒé«˜ç‰ˆæœ¬å­˜åœ¨ã€‚æ¯”å¦‚
|jar åŒ…ç‰ˆæœ¬|æ˜¯å¦å­˜åœ¨|
|:-----|:-----|
|4.3.6|å¦| 
|4.4|æ˜¯|

é‚£å½“æˆ‘ä»¬ç¡®å®éœ€è¦ç”¨åˆ° NoopHostnameVerifier è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬çœ‹åˆ° Maven é€šè¿‡ä¾èµ–ä¼ é€’æœºåˆ¶å¼•å…¥äº†è¿™ä¸ª jar åŒ…ï¼Œæ‰€ä»¥æ²¡æœ‰æ˜ç¡®åœ°æ˜¾å¼å£°æ˜å¯¹è¿™ä¸ª jar åŒ…çš„ä¾èµ–ã€‚å¯æ˜¯ Maven ä¼ é€’è¿‡æ¥çš„ jar åŒ…æ˜¯ 4.3.6 ç‰ˆæœ¬ï¼Œé‡Œé¢æ²¡æœ‰åŒ…å«æˆ‘ä»¬éœ€è¦çš„ç±»ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

è€Œã€å†²çªã€ä½“ç°åœ¨ï¼š4.3.6 å’Œ 4.4 è¿™ä¸¤ä¸ªç‰ˆæœ¬çš„ jar åŒ…éƒ½è¢«æ¡†æ¶æ‰€ä¾èµ–çš„ jar åŒ…ç»™ä¼ é€’è¿›æ¥äº†ï¼Œä½†æ˜¯å‡è®¾ Maven æ ¹æ®ã€ç‰ˆæœ¬ä»²è£ã€è§„åˆ™å®é™…é‡‡çº³çš„æ˜¯ 4.3.6ã€‚

### â‘¡æŠ›å¼‚å¸¸ï¼šæ‰¾ä¸åˆ°æ–¹æ³•
ç¨‹åºæ‰¾ä¸åˆ°ç¬¦åˆé¢„æœŸçš„æ–¹æ³•ã€‚è¿™ç§æƒ…å†µå¤šè§äºé€šè¿‡åå°„è°ƒç”¨æ–¹æ³•ï¼Œæ‰€ä»¥ç»å¸¸ä¼šå¯¼è‡´ï¼šjava.lang.NoSuchMethodErrorã€‚æ¯”å¦‚ antlr:antlr:x.x.x è¿™ä¸ªåŒ…ä¸­æœ‰ä¸€ä¸ªæ¥å£ï¼šantlr.collections.AST
|ç‰ˆæœ¬|getLine()æ–¹æ³•|
|:-----|:-----|
|2.7.2|æ— |
|2.7.6|æœ‰| 

### â‘¢æ²¡æŠ¥é”™ä½†ç»“æœä¸å¯¹
å‘ç”Ÿè¿™ç§æƒ…å†µæ¯”è¾ƒå…¸å‹çš„åŸå› æ˜¯ï¼šä¸¤ä¸ª jar åŒ…ä¸­çš„ç±»åˆ†åˆ«å®ç°äº†åŒä¸€ä¸ªæ¥å£ï¼Œè¿™æœ¬æ¥æ˜¯å¾ˆæ­£å¸¸çš„ã€‚ä½†æ˜¯é—®é¢˜åœ¨äºï¼šç”±äºæ²¡æœ‰æ³¨æ„å‘½åè§„èŒƒï¼Œä¸¤ä¸ªä¸åŒå®ç°ç±»æ°å·§æ˜¯åŒä¸€ä¸ªåå­—ã€‚
![](images/Pasted%20image%2020221128173913.png)
å…·ä½“ä¾‹å­æ˜¯æœ‰çš„åŒå­¦åœ¨å®é™…å·¥ä½œä¸­é‡åˆ°è¿‡ï¼šé¡¹ç›®ä¸­éƒ¨åˆ†æ¨¡å—ä½¿ç”¨ log4j æ‰“å°æ—¥å¿—ï¼›å…¶å®ƒæ¨¡å—ä½¿ç”¨ logbackï¼Œç¼–è¯‘è¿è¡Œéƒ½ä¸ä¼šå†²çªï¼Œä½†æ˜¯ä¼šå¼•èµ·æ—¥å¿—æœåŠ¡é™çº§ï¼Œè®©ä½ çš„ log é…ç½®æ–‡ä»¶å¤±æ•ˆã€‚æ¯”å¦‚ï¼šä½ æŒ‡å®šäº† error çº§åˆ«è¾“å‡ºï¼Œä½†æ˜¯å†²çªå°±ä¼šå¯¼è‡´ infoã€debug éƒ½åœ¨è¾“å‡ºã€‚

## 3ã€æœ¬è´¨
ä»¥ä¸Šè¡¨ç°å½¢å¼å½’æ ¹åˆ°åº•æ˜¯**ä¸¤ç§åŸºæœ¬æƒ…å†µ**å¯¼è‡´çš„ï¼š

### â‘ åŒä¸€jaråŒ…çš„ä¸åŒç‰ˆæœ¬
![](images/Pasted%20image%2020221128174011.png)
### â‘¡ä¸åŒjaråŒ…ä¸­åŒ…å«åŒåç±»
è¿™é‡Œæˆ‘ä»¬æ‹¿ netty æ¥ä¸¾ä¸ªä¾‹å­ï¼Œnetty æ˜¯ä¸€ä¸ªç±»ä¼¼ Tomcat çš„ Servlet å®¹å™¨ã€‚é€šå¸¸æˆ‘ä»¬ä¸ä¼šç›´æ¥ä¾èµ–å®ƒï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šéƒ½æ˜¯æ¡†æ¶ä¼ é€’è¿›æ¥çš„ã€‚é‚£ä¹ˆå½“æˆ‘ä»¬ç”¨åˆ°çš„æ¡†æ¶å¾ˆå¤šæ—¶ï¼Œå°±ä¼šæœ‰ä¸åŒçš„æ¡†æ¶ç”¨ä¸åŒçš„åæ ‡å¯¼å…¥ nettyã€‚å¤§å®¶å¯ä»¥å‚ç…§ä¸‹è¡¨å¯¹æ¯”ä¸€ä¸‹ä¸¤ç»„åæ ‡ï¼š
![](images/Pasted%20image%2020221128180638.png)
ä½†æ˜¯ååè¿™ä¸¤ä¸ªã€ä¸åŒçš„åŒ…ã€é‡Œé¢åˆæœ‰å¾ˆå¤šã€å…¨é™å®šåç›¸åŒã€çš„ç±»ã€‚ä¾‹å¦‚ï¼š
> org.jboss.netty.channel.socket.ServerSocketChannelConfig.class org.jboss.netty.channel.socket.nio.NioSocketChannelConfig.class org.jboss.netty.util.internal.jzlib.Deflate.class org.jboss.netty.handler.codec.serialization.ObjectDecoder.class org.jboss.netty.util.internal.ConcurrentHashMap$HashIterator.class org.jboss.netty.util.internal.jzlib.Tree.class org.jboss.netty.util.internal.ConcurrentIdentityWeakKeyHashMap$Segment.class org.jboss.netty.handler.logging.LoggingHandler.class org.jboss.netty.channel.ChannelHandlerLifeCycleException.class org.jboss.netty.util.internal.ConcurrentIdentityHashMap$ValueIterator.class org.jboss.netty.util.internal.ConcurrentIdentityWeakKeyHashMap$Values.class org.jboss.netty.util.internal.UnterminatableExecutor.class org.jboss.netty.handler.codec.compression.ZlibDecoder.class org.jboss.netty.handler.codec.rtsp.RtspHeaders$Values.class org.jboss.netty.handler.codec.replay.ReplayError.class org.jboss.netty.buffer.HeapChannelBufferFactory.class
> â€¦â€¦

å…¶å®è¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œåˆ—å‡ºçš„åªæ˜¯å†°å±±ä¸€è§’ã€‚

å½“ç„¶ï¼Œå¦‚æœå…¨é™å®šåç›¸åŒï¼Œç±»ä¸­çš„ä»£ç ä¹Ÿå®Œå…¨ç›¸åŒï¼Œé‚£ä¹ˆç”¨ç€ä¹Ÿè¡Œã€‚é—®é¢˜æ˜¯å¦‚æœã€å…¨é™å®šåç›¸åŒã€ï¼Œä½†æ˜¯ã€ä»£ç ä¸åŒã€ï¼Œé‚£å¯å¤ªå‘äº†ã€‚æˆ‘ä»¬éšä¾¿æ‰¾ä¸€ä¸ªæ¥çœ‹çœ‹ï¼š

åæ ‡ä¿¡æ¯ï¼š`org.jboss.netty:netty:jar:3.2.10.Final`
ä»£ç æˆªå›¾ï¼š
![](images/Pasted%20image%2020221128180836.png)

åæ ‡ä¿¡æ¯ï¼š`io.netty:netty:jar:3.9.2.Final`
![](images/Pasted%20image%2020221128180904.png)

## 4ã€è§£å†³åŠæ³•
### â‘ æ¦‚è¿°

å¾ˆå¤šæƒ…å†µä¸‹å¸¸ç”¨æ¡†æ¶ä¹‹é—´çš„æ•´åˆå®¹æ˜“å‡ºç°çš„å†²çªé—®é¢˜éƒ½æœ‰äººæ€»ç»“è¿‡äº†ï¼Œæ‹¿æŠ›å‡ºçš„å¼‚å¸¸æœç´¢ä¸€ä¸‹åŸºæœ¬ä¸Šå°±å¯ä»¥ç›´æ¥æ‰¾åˆ°å¯¹åº”çš„ jar åŒ…ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥è¦è¯´çš„æ˜¯é€šç”¨æ–¹æ³•ã€‚
ä¸ç®¡å…·ä½“ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆå·¥å…·ï¼ŒåŸºæœ¬æ€è·¯æ— éæ˜¯è¿™ä¹ˆä¸¤æ­¥ï¼š
-   ç¬¬ä¸€æ­¥ï¼šæŠŠå½¼æ­¤å†²çªçš„ jar åŒ…æ‰¾åˆ°
-   ç¬¬äºŒæ­¥ï¼šåœ¨å†²çªçš„ jar åŒ…ä¸­é€‰å®šä¸€ä¸ªã€‚å…·ä½“åšæ³•æ— éæ˜¯é€šè¿‡ exclusions æ’é™¤ä¾èµ–ï¼Œæˆ–æ˜¯æ˜ç¡®å£°æ˜ä¾èµ–ã€‚

### â‘¡IDEA çš„ Maven Helper æ’ä»¶
è¿™ä¸ªæ’ä»¶æ˜¯ IDEA ä¸­å®‰è£…çš„æ’ä»¶ï¼Œä¸æ˜¯ Maven æ’ä»¶ã€‚å®ƒèƒ½å¤Ÿç»™æˆ‘ä»¬ç½—åˆ—å‡ºæ¥åŒä¸€ä¸ª jar åŒ…çš„ä¸åŒç‰ˆæœ¬ï¼Œä»¥åŠå®ƒä»¬çš„æ¥æºã€‚ä½†æ˜¯å¯¹ä¸åŒ jar åŒ…ä¸­åŒåçš„ç±»æ²¡æœ‰åŠæ³•ã€‚
- åœ¨ IDEA ä¸­å®‰è£… Maven helper æ’ä»¶ã€‚
- åŸºäº pom.xml çš„ä¾èµ–å†²çªåˆ†æã€‚

### â‘¢Maven çš„ enforcer æ’ä»¶
ä½¿ç”¨ Maven çš„ enforcer æ’ä»¶æ—¢å¯ä»¥æ£€æµ‹åŒä¸€ä¸ª jar åŒ…çš„ä¸åŒç‰ˆæœ¬ï¼Œåˆå¯ä»¥æ£€æµ‹ä¸åŒ jar åŒ…ä¸­åŒåçš„ç±»ã€‚

#### [1]å¼•å…¥ netty ä¾èµ–
è¿™é‡Œæˆ‘ä»¬å¼•å…¥ä¸¤ä¸ªå¯¹ netty çš„ä¾èµ–ï¼Œå±•ç¤ºä¸åŒ jar åŒ…ä¸­æœ‰åŒåç±»çš„æƒ…å†µã€‚
```xml
<dependencies>
    <dependency>
        <groupId>org.jboss.netty</groupId>
        <artifactId>netty</artifactId>
        <version>3.2.10.Final</version>
    </dependency>

    <dependency>
        <groupId>io.netty</groupId>
        <artifactId>netty</artifactId>
        <version>3.9.2.Final</version>
    </dependency>
</dependencies>
```

#### [2]é…ç½® enforcer æ’ä»¶
```xml
<build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-enforcer-plugin</artifactId>
                <version>1.4.1</version>
                <executions>
                    <execution>
                        <id>enforce-dependencies</id>
                        <phase>validate</phase>
                        <goals>
                            <goal>display-info</goal>
                            <goal>enforce</goal>
                        </goals>
                    </execution>
                </executions>
                <dependencies>
                    <dependency>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>extra-enforcer-rules</artifactId>
                        <version>1.0-beta-4</version>
                    </dependency>
                </dependencies>
                <configuration>
                    <rules>
                        <banDuplicateClasses>
                            <findAllDuplicates>true</findAllDuplicates>
                        </banDuplicateClasses>
                    </rules>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
</build>
```

#### [3]æµ‹è¯•
æ‰§è¡Œå¦‚ä¸‹ Maven å‘½ä»¤ï¼š
```sh
mvn clean package enforcer:enforce
```
éƒ¨åˆ†è¿è¡Œç»“æœï¼š

> [INFO] --- maven-enforcer-plugin:1.4.1:enforce (default-cli) @ pro32-duplicate-class ---  
> [WARNING] Rule 0: org.apache.maven.plugins.enforcer.BanDuplicateClasses failed with message:  
> Duplicate classes found:  
> 
> Found in:  
> io.netty:netty:jar:3.9.2.Final:compile  
> org.jboss.netty:netty:jar:3.2.10.Final:compile  
> Duplicate classes:  
> org/jboss/netty/channel/socket/ServerSocketChannelConfig.class  
> org/jboss/netty/channel/socket/nio/NioSocketChannelConfig.class  
> org/jboss/netty/util/internal/jzlib/Deflate.class  
> org/jboss/netty/handler/codec/serialization/ObjectDecoder.class  
> org/jboss/netty/util/internal/ConcurrentHashMap$HashIterator.class  
> 
> â€¦â€¦

# ç¬¬ä¸‰èŠ‚ ä½“ç³»å¤– jar åŒ…å¼•å…¥

## 1ã€æå‡ºé—®é¢˜

ã€ä½“ç³»å¤– jar åŒ…ã€ä¸æ˜¯å®˜æ–¹çš„æœ¯è¯­ï¼Œæ¥æºæ˜¯è¿™æ ·â€”â€”ç›®å‰æ¥è¯´æˆ‘ä»¬åœ¨ Maven å·¥ç¨‹ä¸­ç”¨åˆ°çš„ jar åŒ…éƒ½æ˜¯é€šè¿‡ Maven æœ¬èº«çš„æœºåˆ¶å¯¼å…¥è¿›æ¥çš„ã€‚
è€Œå®é™…å¼€å‘ä¸­ç¡®å®æœ‰å¯èƒ½ç”¨åˆ°ä¸€äº› jar åŒ…å¹¶éæ˜¯ç”¨ Maven çš„æ–¹å¼å‘å¸ƒï¼Œé‚£è‡ªç„¶ä¹Ÿæ²¡æ³•é€šè¿‡ Maven å¯¼å…¥ã€‚
æ­¤æ—¶å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ‹¿åˆ°è¯¥ jar åŒ…çš„æºç é‚£è¿˜å¯ä»¥è‡ªå·±å»ºä¸€ä¸ª Maven å·¥ç¨‹ï¼Œè‡ªå·±æ‰“åŒ…ã€‚å¯æ˜¯å¦‚æœè¿æºç éƒ½æ²¡æœ‰å‘¢ï¼Ÿ
è¿™æ–¹é¢çš„ä¾‹å­åŒ…æ‹¬ä¸€äº›äººè„¸è¯†åˆ«ç”¨çš„ jar åŒ…ã€æµ·åº·è§†é¢‘ç›‘æ§ jar åŒ…ç­‰ç­‰ã€‚

## 2ã€è§£å†³åŠæ³•
### â‘ å‡†å¤‡ä¸€ä¸ªä½“ç³»å¤– jar åŒ…
æˆ‘ä»¬é€šè¿‡å­¦ Maven ä»¥å‰çš„æ–¹å¼åˆ›å»ºä¸€ä¸ª Java å·¥ç¨‹ï¼Œç„¶åå¯¼å‡º jar åŒ…å³å¯ç”¨æ¥æµ‹è¯•ã€‚
![](images/Pasted%20image%2020221128181817.png)
![](images/Pasted%20image%2020221128181822.png)
![](images/Pasted%20image%2020221128181826.png)
![](images/Pasted%20image%2020221128181830.png)
![](images/Pasted%20image%2020221128181835.png)
![](images/Pasted%20image%2020221128181840.png)
![](images/Pasted%20image%2020221128181844.png)
![](images/Pasted%20image%2020221128181851.png)

### â‘¡å°†è¯¥ jar åŒ…å®‰è£…åˆ° Maven ä»“åº“
è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ install æ’ä»¶çš„ install-file ç›®æ ‡ï¼š
```sh
mvn install:install-file -Dfile=[ä½“ç³»å¤– jar åŒ…è·¯å¾„] \
-DgroupId=[ç»™ä½“ç³»å¤– jar åŒ…å¼ºè¡Œè®¾å®šåæ ‡] \
-DartifactId=[ç»™ä½“ç³»å¤– jar åŒ…å¼ºè¡Œè®¾å®šåæ ‡] \
-Dversion=1 \
-Dpackage=jar
```

ä¾‹å¦‚ï¼ˆWindows ç³»ç»Ÿä¸‹ä½¿ç”¨ ^ ç¬¦å·æ¢è¡Œï¼›Linux ç³»ç»Ÿç”¨ \ï¼‰ï¼š
```sh
mvn install:install-file -Dfile=D:\idea2019workspace\atguigu-maven-outer\out\artifacts\atguigu_maven_outer\atguigu-maven-outer.jar ^
-DgroupId=com.atguigu.maven ^
-DartifactId=atguigu-maven-outer ^
-Dversion=1 ^
-Dpackaging=jar
```
æ‰§è¡Œç»“æœï¼š
![](images/Pasted%20image%2020221128181935.png)
å†çœ‹æœ¬åœ°ä»“åº“ä¸­ç¡®å®æœ‰ï¼š
![](images/Pasted%20image%2020221128181943.png)
æˆ‘ä»¬æ‰“å¼€ POM æ–‡ä»¶çœ‹çœ‹ï¼š
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd" xmlns="http://maven.apache.org/POM/4.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.atguigu.maven</groupId>
  <artifactId>atguigu-maven-outer</artifactId>
  <version>1</version>
  <description>POM was created from install:install-file</description>
</project>
```

### â‘¢æµ‹è¯•
åœ¨å…¶å®ƒåœ°æ–¹ä¾èµ–è¿™ä¸ª jar åŒ…ï¼š
```xml
<dependency>
    <groupId>com.atguigu.maven</groupId>
    <artifactId>atguigu-maven-outer</artifactId>
    <version>1</version>
</dependency>
```

åˆ›å»ºå¯¹è±¡ã€è°ƒç”¨æ–¹æ³•ï¼š
![](images/Pasted%20image%2020221128182027.png)

